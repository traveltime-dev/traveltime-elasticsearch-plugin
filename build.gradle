buildscript {
    repositories {
        gradlePluginPortal()
    }

    dependencies {
        classpath "io.freefair.gradle:lombok-plugin:5.3.0"
    }
}

group = 'com.traveltime'
version = '0.2-SNAPSHOT'

repositories {
    maven {
        url = 'https://snapshots.elastic.co/maven/'
    }
    mavenCentral()
}

apply plugin: "io.freefair.lombok"

apply plugin: 'java'

compileJava {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

dependencies {
    compileOnly 'org.elasticsearch:elasticsearch:7.10.2'
    implementation('com.traveltime:traveltime-sdk-java:1.1.0') {
        exclude group: 'com.fasterxml.jackson.core'
        exclude group: 'org.locationtech.jts'
    }
    implementation group: 'com.google.guava', name: 'guava', version: '31.0.1-jre'
    implementation 'io.vavr:vavr:0.10.4'
    implementation group: 'it.unimi.dsi', name: 'fastutil', version: '8.5.6'
}

task pluginZip(dependsOn: jar, type: Zip) {
    archiveName project.name + ".zip"
    from configurations.runtime.allArtifacts.files
    from configurations.runtimeClasspath
    from "src/universal/" include '*'
}